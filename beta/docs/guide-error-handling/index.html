<!DOCTYPE html> <html lang=en> <head> <meta charset=utf-8> <meta content="width=device-width,initial-scale=1" name=viewport> <meta content=#333333 name=theme-color> <base href=/ > <link href=https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.5/css/bulma.min.css rel=stylesheet crossorigin=anonymous integrity="sha256-vK3UTo/8wHbaUn+dTQD0X6dzidqc5l7gczvH+Bnowwk="> <link href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/atom-one-light.min.css rel=stylesheet crossorigin=anonymous integrity="sha256-VCcaD9+X/d4QGYRX7l5aMJ8BWgwfA8d3S7i/HC9rvvw="> <link href=global.css rel=stylesheet> <link href=manifest.json rel=manifest> <link href=favicon.png rel=icon type=image/png> <link href=client/main.217497995.css rel=stylesheet> <noscript id=sapper-head-start></noscript><title>Guide: Error handling – atscm</title><meta content="Guide: Error handling in the atscm manual pages" name=description><noscript id=sapper-head-end></noscript> </head> <body> <div id=sapper> <div class="fullscreen-content svelte-30lnsi"><nav class="is-spaced navbar"><div class=container><div class=navbar-brand> <a href=. class=navbar-item><strong>atscm</strong></a> <div class="burger navbar-burger" role=button><span aria-hidden=true></span> <span aria-hidden=true></span> <span aria-hidden=true></span></div></div> <div class=navbar-menu><div class=navbar-start><a href=beta class=navbar-item>Readme </a> <a href=beta/docs class="navbar-item is-active">Manual </a> <a href=beta/api class=navbar-item>Reference </a></div> <div class=navbar-end><div class="navbar-item has-dropdown is-hoverable"><p class=navbar-link><span>Version: <strong>beta</strong></span></p> <div class="is-right navbar-dropdown"><a href=latest class="navbar-item is-flex"><span>latest (1.1.0)</span> </a><a href=beta class="navbar-item is-active is-flex"><span>beta (1.0.0-beta.51)</span> </a></div></div> <div class="navbar-item search-item"> <div class=dropdown><div class=dropdown-trigger><div class=field><div class="control has-icons-left"><input class=input placeholder=Search... type=search> <span class="icon is-left is-small"><i class="fa-search fas"></i></span></div></div></div> </div></div> <div class=navbar-item><div class=buttons><a href=https://github.com/atscm class="button is-light"><span class=icon><i class="fa-github fab"></i></span></a></div></div></div></div></div></nav> <div class=message-section><div class=container><div class="is-warning message"><div class=message-body>Documentation for beta releases may be incomplete.</div></div></div></div> <section class=section><div class=container><div class=columns><div class=column> <div class=content><h1 id=guide-error-handling>Guide: Error handling</h1><h2 id=adding-source-locations>Adding source locations</h2><p>When a throwing an Error that was caused by client code, you should provide location info so it can be traced back to the source code.</p> <p>To do so, simply add additional properties to the error object, containing the source code, the start location and (optionally) the end location.</p> <pre><code class=language-javascript><span class=hljs-function><span class=hljs-keyword>function</span> <span class=hljs-title>myTransformCode</span>(<span class=hljs-params></span>) </span>{
  <span class=hljs-keyword>const</span> sourceCode = <span class=hljs-string>'the code transformed'</span>;

  <span class=hljs-keyword>try</span> {
    <span class=hljs-comment>// Do something that may throw an error...</span>
  } <span class=hljs-keyword>catch</span> (error) {
    <span class=hljs-built_in>Object</span>.assign(error, {
      <span class=hljs-attr>rawLines</span>: sourceCode, <span class=hljs-comment>// A string containing the raw source code</span>
      location: {
        <span class=hljs-attr>start</span>: {
          <span class=hljs-attr>line</span>: <span class=hljs-number>1</span>, <span class=hljs-comment>// The line number</span>
          column: <span class=hljs-number>1</span>, <span class=hljs-comment>// The column number</span>
        },
        <span class=hljs-comment>// you could add a 'end' property here, with the same signature as 'start'</span>
      },
    });

    <span class=hljs-comment>// Finally re-throw the error</span>
    <span class=hljs-keyword>throw</span> error;
  }
}</code></pre> <p><strong>Example output: XML Parse error</strong></p> <pre><code>[13:30:28] Using gulpfile ~/Downloads/delete/atscm-330/node_modules/atscm/out/Gulpfile.js
[13:30:28] Starting 'pull'...
[13:30:30] 'pull' errored after 1.09 s
[13:30:30] closing tag mismatch
  5 |   &lt;atv:gridconfig width="20" gridstyle="lines" enabled="false" height="20"/>
  6 |   &lt;atv:snapconfig width="10" enabled="false" height="10"/>
> 7 |  &lt;/metadata>
    |  ^ closing tag mismatch
  8 | &lt;/svg>
  9 |
   - Node: AGENT.DISPLAYS.Main</code></pre><p><strong>Details</strong></p> <ul> <li><a href=https://babeljs.io/docs/en/babel-code-frame><code>@babel/code-frame</code></a> is used to render the frame.</li> </ul> </div></div> <div class="column is-3"><aside class=menu><ul class=menu-list><li><a href=beta/docs/node-id-conflicts>Node ID conflicts</a> <li><a href=beta/docs/guide-gulpjs-plugins>Guide: gulp.js plugins</a> <li><a href=beta/docs/guide-debugging-atscm>Guide: Debugging atscm</a> <li><a href=beta/docs/guide-error-handling class=is-active>Guide: Error handling</a> <ul class=menu-list><li><a href=beta/docs/guide-error-handling/#adding-source-locations>Adding source locations</a> </li> </ul> <li><a href=beta/docs/tutorial-custom-transformer>Tutorial: Custom Transformer</a> <li><a href=beta/docs/contribute-testing-atscm>Contribute: Testing atscm</a> <li><a href=beta/docs/contributing>Contributing</a> <li><a href=beta/docs/changelog>Changelog</a> </ul></aside></div></div></div></section></div> <footer class=footer><div class="content has-text-centered"><p><strong>atscm</strong> is an open source project by <a href=https://bachmann.info>Bachmann electronics</a> · The source code is licensed <a href=http://opensource.org/licenses/mit-license.php>MIT</a></p> <p><a href=https://github.com/atSCM/atscm/blob/master/.github/CONTRIBUTING.md target=_blank>Get involved </a> · <a href=https://github.com/atSCM/docs target=_blank>Improve this page</a> · <a href=https://www.bachmann.info/en/info/imprint/ target=_blank>Imprint</a></div></footer> </div> <script>__SAPPER__={baseUrl:"",preloaded:[void 0,{},(function(a,b,c,d,e,f,g,h,i){return {topics:[{title:"Node ID conflicts",slug:"node-id-conflicts",sections:[{title:"How atscm handles id conflicts",slug:"how-atscm-handles-id-conflicts"},{title:"How to resolve id conflicts",slug:"how-to-resolve-id-conflicts"}]},{title:"Guide: gulp.js plugins",slug:"guide-gulpjs-plugins",sections:[{title:"Using Transformer class",slug:"using-transformer-class"},{title:"Using PartialTransformer class",slug:"using-partialtransformer-class"},{title:d,slug:e},{title:f,slug:g}]},{title:"Guide: Debugging atscm",slug:"guide-debugging-atscm",sections:[]},{title:"Guide: Error handling",slug:"guide-error-handling",sections:[{title:"Adding source locations",slug:"adding-source-locations"}]},{title:"Tutorial: Custom Transformer",slug:"tutorial-custom-transformer",sections:[{title:"Overview",slug:"overview"},{title:"Step 0: Project setup",slug:"step-0-project-setup"},{title:"Step 1: Import PartialTransformer class",slug:"step-1-import-partialtransformer-class"},{title:"Step 2: Create the BabelTransformer class",slug:"step-2-create-the-babeltransformer-class"},{title:"Step 3: Use BabelTransformer",slug:"step-3-use-babeltransformer"},{title:"Step 4: Implement PartialTransformer#shouldBeTransformed",slug:"step-4-implement-partialtransformershouldbetransformed"},{title:"Step 5: Implement Transformer#transformFromFilesystem",slug:"step-5-implement-transformertransformfromfilesystem"},{title:"Step 6: Test BabelTransformer",slug:"step-6-test-babeltransformer"},{title:"Step 7: Implement Transformer#transformFromDB",slug:"step-7-implement-transformertransformfromdb"},{title:"Result",slug:"result"},{title:d,slug:e},{title:f,slug:g}]},{title:"Contribute: Testing atscm",slug:"contribute-testing-atscm",sections:[{title:"Unit tests",slug:"unit-tests"},{title:"Integration tests",slug:"integration-tests",children:[{title:"Test setups",slug:"test-setups"}]}]},{title:"Contributing",slug:"contributing",sections:[{title:"Found a bug?",slug:"found-a-bug"},{title:"Missing a feature?",slug:"missing-a-feature"},{title:"Submission Guidelines",slug:"submission-guidelines",children:[{title:"Submitting an issue",slug:"submitting-an-issue"},{title:"Submitting a Pull Request (PR)",slug:"submitting-a-pull-request-pr"}]},{title:"Code quality control",slug:"code-quality-control"},{title:"Setting up the development environment",slug:"setting-up-the-development-environment",children:[{title:"Linting files",slug:"linting-files"},{title:"Running tests",slug:"running-tests"},{title:"Creating API documentation",slug:"creating-api-documentation"}]},{title:"Commit Message Guideline",slug:"commit-message-guideline",children:[{title:"Commit message format",slug:"commit-message-format",children:[{title:"Type",slug:"type"},{title:"Scope",slug:"scope"},{title:"Subject",slug:"subject"},{title:"Body",slug:"body"},{title:"Footer",slug:"footer"}]},{title:"Commit message linting",slug:"commit-message-linting"}]}]},{title:"Changelog",slug:"changelog",sections:[{title:"1.0.0-beta.51 (2020-04-21)",slug:"100-beta51-2020-04-21",children:[{title:a,slug:"bug-fixes",children:[{title:b,slug:"features"},{title:c,slug:"performance-improvements"},{title:h,slug:"breaking-changes"}]}]},{title:"0.6.0 (2018-06-17)",slug:"060-2018-06-17",children:[{title:a,slug:"bug-fixes-1",children:[{title:b,slug:"features-1"}]},{title:"0.5.1 (2018-02-16)",slug:"051-2018-02-16",children:[{title:a,slug:"bug-fixes-2"}]}]},{title:"0.5.0 (2018-02-09)",slug:"050-2018-02-09",children:[{title:b,slug:"features-2"},{title:"0.4.3 (2018-02-08)",slug:"043-2018-02-08",children:[{title:a,slug:"bug-fixes-3"}]},{title:"0.4.2 (2017-12-19)",slug:"042-2017-12-19",children:[{title:a,slug:"bug-fixes-4"}]},{title:"0.4.1 (2017-12-18)",slug:"041-2017-12-18",children:[{title:a,slug:"bug-fixes-5"},{title:i,slug:"reverts"}]}]},{title:"0.4.0 (2017-11-21)",slug:"040-2017-11-21",children:[{title:a,slug:"bug-fixes-6",children:[{title:b,slug:"features-3"}]}]},{title:"0.3.0 (2017-05-08)",slug:"030-2017-05-08",children:[{title:a,slug:"bug-fixes-7",children:[{title:b,slug:"features-4"},{title:i,slug:"reverts-1"}]},{title:"0.2.4 (2017-04-05)",slug:"024-2017-04-05",children:[{title:a,slug:"bug-fixes-8"}]},{title:"0.2.3 (2017-04-05)",slug:"023-2017-04-05",children:[{title:a,slug:"bug-fixes-9"}]},{title:"0.2.2 (2017-03-20)",slug:"022-2017-03-20",children:[{title:a,slug:"bug-fixes-10"},{title:b,slug:"features-5"},{title:c,slug:"performance-improvements-1"}]},{title:"0.2.1 (2017-03-13)",slug:"021-2017-03-13",children:[{title:a,slug:"bug-fixes-11"},{title:"Chores",slug:"chores"},{title:b,slug:"features-6"},{title:c,slug:"performance-improvements-2"},{title:h,slug:"breaking-changes-1"}]}]},{title:"0.2.0 (2017-03-08)",slug:"020-2017-03-08",children:[{title:a,slug:"bug-fixes-12",children:[{title:b,slug:"features-7"}]},{title:"0.1.2 (2017-02-23)",slug:"012-2017-02-23"},{title:"0.1.1 (2017-02-22)",slug:"011-2017-02-22",children:[{title:a,slug:"bug-fixes-13"},{title:b,slug:"features-8"},{title:c,slug:"performance-improvements-3"}]}]},{title:"0.1.0 (2017-02-21)",slug:"010-2017-02-21"}]}]}}("Bug Fixes","Features","Performance Improvements","Conclusion","conclusion","Further reading","further-reading","BREAKING CHANGES","Reverts")),{manual:{content:"\u003Ch1 id=\"guide-error-handling\"\u003EGuide: Error handling\u003C\u002Fh1\u003E\u003Ch2 id=\"adding-source-locations\"\u003EAdding source locations\u003C\u002Fh2\u003E\u003Cp\u003EWhen a throwing an Error that was caused by client code, you should provide location info so it can be traced back to the source code.\u003C\u002Fp\u003E\n\u003Cp\u003ETo do so, simply add additional properties to the error object, containing the source code, the start location and (optionally) the end location.\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-javascript\"\u003E\u003Cspan class=\"hljs-function\"\u003E\u003Cspan class=\"hljs-keyword\"\u003Efunction\u003C\u002Fspan\u003E \u003Cspan class=\"hljs-title\"\u003EmyTransformCode\u003C\u002Fspan\u003E(\u003Cspan class=\"hljs-params\"\u003E\u003C\u002Fspan\u003E) \u003C\u002Fspan\u003E{\n  \u003Cspan class=\"hljs-keyword\"\u003Econst\u003C\u002Fspan\u003E sourceCode = \u003Cspan class=\"hljs-string\"\u003E'the code transformed'\u003C\u002Fspan\u003E;\n\n  \u003Cspan class=\"hljs-keyword\"\u003Etry\u003C\u002Fspan\u003E {\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F Do something that may throw an error...\u003C\u002Fspan\u003E\n  } \u003Cspan class=\"hljs-keyword\"\u003Ecatch\u003C\u002Fspan\u003E (error) {\n    \u003Cspan class=\"hljs-built_in\"\u003EObject\u003C\u002Fspan\u003E.assign(error, {\n      \u003Cspan class=\"hljs-attr\"\u003ErawLines\u003C\u002Fspan\u003E: sourceCode, \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F A string containing the raw source code\u003C\u002Fspan\u003E\n      location: {\n        \u003Cspan class=\"hljs-attr\"\u003Estart\u003C\u002Fspan\u003E: {\n          \u003Cspan class=\"hljs-attr\"\u003Eline\u003C\u002Fspan\u003E: \u003Cspan class=\"hljs-number\"\u003E1\u003C\u002Fspan\u003E, \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F The line number\u003C\u002Fspan\u003E\n          column: \u003Cspan class=\"hljs-number\"\u003E1\u003C\u002Fspan\u003E, \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F The column number\u003C\u002Fspan\u003E\n        },\n        \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F you could add a 'end' property here, with the same signature as 'start'\u003C\u002Fspan\u003E\n      },\n    });\n\n    \u003Cspan class=\"hljs-comment\"\u003E\u002F\u002F Finally re-throw the error\u003C\u002Fspan\u003E\n    \u003Cspan class=\"hljs-keyword\"\u003Ethrow\u003C\u002Fspan\u003E error;\n  }\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003E\u003Cstrong\u003EExample output: XML Parse error\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode\u003E[13:30:28] Using gulpfile ~\u002FDownloads\u002Fdelete\u002Fatscm-330\u002Fnode_modules\u002Fatscm\u002Fout\u002FGulpfile.js\n[13:30:28] Starting &#39;pull&#39;...\n[13:30:30] &#39;pull&#39; errored after 1.09 s\n[13:30:30] closing tag mismatch\n  5 |   &lt;atv:gridconfig width=&quot;20&quot; gridstyle=&quot;lines&quot; enabled=&quot;false&quot; height=&quot;20&quot;\u002F&gt;\n  6 |   &lt;atv:snapconfig width=&quot;10&quot; enabled=&quot;false&quot; height=&quot;10&quot;\u002F&gt;\n&gt; 7 |  &lt;\u002Fmetadata&gt;\n    |  ^ closing tag mismatch\n  8 | &lt;\u002Fsvg&gt;\n  9 |\n   - Node: AGENT.DISPLAYS.Main\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003E\u003Cstrong\u003EDetails\u003C\u002Fstrong\u003E\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ca href=\"https:\u002F\u002Fbabeljs.io\u002Fdocs\u002Fen\u002Fbabel-code-frame\"\u003E\u003Ccode\u003E@babel\u002Fcode-frame\u003C\u002Fcode\u003E\u003C\u002Fa\u003E is used to render the frame.\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n",sections:[{title:"Adding source locations",slug:"adding-source-locations"}],title:"Guide: Error handling"}}]};if('serviceWorker' in navigator)navigator.serviceWorker.register('/service-worker.js');(function(){try{eval("async function x(){}");var main="/client/c.client.093187a1.js"}catch(e){main="/client/legacy/c.client.ca96cc4b.js"};var s=document.createElement("script");try{new Function("if(0)import('')")();s.src=main;s.type="module";s.crossOrigin="use-credentials";}catch(e){s.src="/client/shimport@1.0.1.js";s.setAttribute("data-main",main);}document.head.appendChild(s);}());</script> <script defer src=https://use.fontawesome.com/releases/v5.3.1/js/all.js></script> 